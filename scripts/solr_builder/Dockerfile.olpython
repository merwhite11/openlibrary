FROM openlibrary/olbase:latest

ENV PYTHONPATH=/openlibrary:/openlibrary/vendor/infogami
ENV PYENV_VERSION=3.9.4

USER root
WORKDIR /openlibrary
RUN pip install -r requirements_test.txt

RUN pip install \
    # For real-time profiling
    cprofilev \
    # Faster python
    Cython

# Build cython files
RUN ./scripts/solr_builder/build-cython.sh

EXPOSE 4000
